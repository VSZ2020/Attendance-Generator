@page
@model AG.Web.Pages.Establishment.EmployeesModel
@using Services.Domains.Security;

@{
    ViewData["Title"] = "Сотрудники";
    bool canAdd = ViewContext.HttpContext.User.IsInRole(CustomRoles.MODERATOR) || ViewContext.HttpContext.User.IsInRole(CustomRoles.ADMIN);
}

<h1 class="display-4">@ViewData["Title"]</h1>
<h2 class="display-5">@Model.DepartmentName</h2>

<a class="btn btn-primary" asp-page="CreateEmployee" asp-route-departmentId="@Model.DepartmentId">Добавить сотрудника</a>

<table class="table table-bordered table-hover table-sm">
    <thead class="thead-light">
        <tr>
            <th scope="col">Фамилия</th>
            <th scope="col">Имя</th>
            <th scope="col">Отчество</th>
            <th scope="col">Доля ставки</th>
            <th scope="col">Должность</th>
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var employee in Model.EmployeesList)
        {
            <tr>
                <td scope="row">@employee.LastName</td>
                <td scope="row">@employee.FirstName</td>
                <td scope="row">@employee.MiddleName</td>
                <td scope="row">@employee.Rate</td>
                <td scope="row">@employee.FunctionName</td>
                <td scope="row">
                <form method="POST">
                        @if (canAdd) {
                            <a asp-page="EditEmployee" asp-route-employeeId="@employee.Id">Редактировать</a> @: | 
                        }
                        <a asp-page="DetailsEmployee" asp-route-employeeId="@employee.Id">Детали</a> |
                        <a asp-handler="Remove" asp-route-employeeId="@employee.Id" type="submit">Удалить</a>
                </form>
                </td>
            </tr>
        }
    </tbody>

</table>
